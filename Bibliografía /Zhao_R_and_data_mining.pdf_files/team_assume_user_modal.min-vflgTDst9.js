define(["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/components/modals/show_modal","modules/clean/teams/admin/modals/modal_ajax","modules/core/browser","spectrum/button","modules/clean/rondo/forms/index","modules/clean/react/css"],(function(e,t,a,n,i,s,o,r,l,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),l=a.__importStar(l);t.NOTIFICATION_MODE_ASSUMED_MEMBER="member",t.NOTIFICATION_MODE_ALL_TEAM_ADMINS="admins",t._getNotificationModeInitState=function(e){return e?t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:t.NOTIFICATION_MODE_ASSUMED_MEMBER};var c=(function(e){function o(s){var o=e.call(this,s)||this;return o._getAssumeModalBody=function(){return n.default.createElement("div",{className:"team-assume-user-modal"},o._getNotificationOptionText()," ",i.intl.formatMessage({defaultMessage:"All actions you perform while signed in as {name} will be recorded in the activity log."},{name:o.props.displayName})+" ",o._shouldShowSettingsModalLink()&&n.default.createElement("button",{className:"button-as-href",id:"assume_change_settings",onClick:o._goToSettings},i.intl.formatMessage({defaultMessage:"Change notification settings"})),n.default.createElement("div",{className:"member-page-settings-notification"},i.intl.formatMessage({defaultMessage:"<b>Note:</b> {firstname}’s settings can only be changed in the <a>members page.</a>"},{a:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("a",{href:"/team/admin/members/member?id="+o.props.userId},e)},b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("span",{className:"bold-text"},e)},firstname:o.props.firstName})))},o._goToSettings=function(){o.setState({isSettingsPage:!0,currNotificationMode:o.props.notificationMode.fieldValue})},o._goToAssumeUser=function(){o.setState({isSettingsPage:!1,currNotificationMode:o.props.notificationMode.fieldValue})},o._clearSettingsAndGoToAssumeUser=function(){o.props.notificationMode.fieldValue=o.state.currNotificationMode,o._goToAssumeUser()},o._getNotificationOptionText=function(){return o._isSingleAdminWithNoMemberNotification()?i.intl.formatMessage({defaultMessage:"A record will be made in the activity log that you have signed in to {name}’s account."},{name:o.props.displayName}):n.default.createElement("span",null,o._getWillBeNotifiedText(o._getNotificantDisplayName()))},o._isSingleAdminWithNoMemberNotification=function(){return!o._hasAdditionalAdmins()&&o.props.notificationMode.fieldValue!==t.NOTIFICATION_MODE_ASSUMED_MEMBER},o._hasAdditionalAdmins=function(){return o.props.shouldNotifyAdmins},o._getNotificantDisplayName=function(){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return o.props.displayName+" ";case t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:return"All team admins ";default:return"Nobody "}},o._getWillBeNotifiedText=function(e){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return i.intl.formatMessage({defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to their account."},{b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("span",{className:"bold-text"},e)},name:e});default:return i.intl.formatMessage({defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to {assume_name}’s account."},{b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("span",{className:"bold-text"},e)},name:e,assume_name:o.props.displayName})}},o._shouldShowSettingsModalLink=function(){return!o.props.isUserSuspended||o._hasAdditionalAdmins()},o._getSettingsModalBody=function(){return n.default.createElement("div",{className:"team-assume-user-modal"},o._renderSettingPhrase(),o._renderSettingsOptions())},o._renderSettingsOptions=function(){return n.default.createElement("div",{className:"settings-selection"},n.default.createElement("div",null,n.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ASSUMED_MEMBER,name:"notificationMode",disabled:o.props.isUserSuspended},o.props.notificationMode),o._radioButtonTextNotificationAssumedMembmer())),n.default.createElement("div",null,n.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ALL_TEAM_ADMINS,name:"notificationMode"},o.props.notificationMode),o._radioButtonTextNotificationAllTeamAdmins())))},o._renderSettingPhrase=function(){return n.default.createElement("div",null,o._hasAdditionalAdmins()?i.intl.formatMessage({defaultMessage:"Who should be notified when you sign in to this member’s account? They will receive an email stating that you signed in as {display_name}."},{display_name:o.props.displayName}):i.intl.formatMessage({defaultMessage:"Where should a record be made when you sign in to this member’s account? If your choice is the member, they will receive an email stating that you signed into their account."}),n.default.createElement("a",{className:"textual-button",id:"assume_learn_more",href:"/help/9185",target:"blank",rel:"noreferrer"},i.intl.formatMessage({defaultMessage:"Learn more"})))},o.state={isSettingsPage:!1,currNotificationMode:t._getNotificationModeInitState(o.props.isUserSuspended)},o}return a.__extends(o,e),o.prototype._radioButtonTextNotificationAssumedMembmer=function(){return i.intl.formatMessage({defaultMessage:"The member and activity log (recommended)",description:"When selecting this radio button, the team member whose Dropbox account is assumed will receive a notification email"})},o.prototype._radioButtonTextNotificationAllTeamAdmins=function(){return this._hasAdditionalAdmins()?i.intl.formatMessage({defaultMessage:"All team admins and activity log",description:"When selecting this radio button, all the team administrators on the team of the team member whose account is assumed will receive an email notification"}):i.intl.formatMessage({defaultMessage:"Team activity log only",description:"When selecting this radio button, there will be no notification and the only documentation wouldbe in the team activity log"})},o.prototype._settingsActionButton=function(){return n.default.createElement(d.Button,{onClick:this._goToAssumeUser},i.intl.formatMessage({defaultMessage:"Save settings"}))},o.prototype._settingsCancelButton=function(){return n.default.createElement(d.Button,{variant:"secondary",onClick:this._clearSettingsAndGoToAssumeUser},i.intl.formatMessage({defaultMessage:"Cancel"}))},o.prototype.render=function(){var e=this,t=this.props,a=t.displayName,o=t.onPrimaryAction,r=t.onSecondaryAction,l=t.onRequestClose,d=this.state.isSettingsPage,u=d?i.intl.formatMessage({defaultMessage:"Sign in as member settings"}):i.intl.formatMessage({defaultMessage:"Sign in as {name}?"},{name:a}),m=d?this._getSettingsModalBody():this._getAssumeModalBody(),c=d?function(){return e._settingsActionButton()}:i.intl.formatMessage({defaultMessage:"Sign in"}),f=d?function(){return e._settingsCancelButton()}:i.intl.formatMessage({defaultMessage:"Cancel"});return n.default.createElement(s.ActionUtilityModal,{title:u,id:"team-assume-user-modal",primaryAction:c,secondaryAction:f,onPrimaryAction:o,onSecondaryAction:r,onRequestClose:l},m)},o})(n.default.Component);t.TeamAssumeUserModal=m.requireCssWithComponent(c,["/static/css/team_assume_user_modal-vflqfLhJ1.css"]),t.ASSUME_TEAM_USER_URL="/team/admin/assume_user",t.TeamAssumeUserModalApp=function(e){var n=e.displayName,i=e.firstName,s=e.userId,o=e.isUserSuspended,d=e.shouldNotifyAdmins,u=a.__rest(e,["displayName","firstName","userId","isUserSuspended","shouldNotifyAdmins"]);return r.modalAjax({modal:t.TeamAssumeUserModal,ajax:{url:t.ASSUME_TEAM_USER_URL,data:function(e){var t=e.notificationMode;return{user_id:s,notification_mode:t,return_url:l.get_href()}}},fields:{notificationMode:{fieldValue:t._getNotificationModeInitState(o)}}})(a.__assign({displayName:n,firstName:i,userId:s,isUserSuspended:o,shouldNotifyAdmins:d},u))},t.showTeamAssumeUserModal=function(e){return o.showModal(n.default.createElement(t.TeamAssumeUserModalApp,a.__assign({},e)))}}));
//# sourceMappingURL=team_assume_user_modal.min.js-vflqnZU5A.map