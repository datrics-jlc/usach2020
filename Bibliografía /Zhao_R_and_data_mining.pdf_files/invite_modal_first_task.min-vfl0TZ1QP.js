define(["require","exports","tslib","react","react-intl","spectrum/modal","dig-components/typography","modules/core/browser_detection","modules/core/i18n","modules/clean/analytics","modules/clean/static_urls","modules/clean/ux_analytics_modal_tracking","modules/clean/viewer","modules/constants/page_load","modules/clean/react/image","modules/clean/teams/constants","modules/clean/teams/modals/team_admin_roles_modal","modules/clean/teams/admin/widgets/admin_permissions_modal/admin_permissions_modal","modules/clean/teams/admin/widgets/invite_modal/invite_modal_member_row","modules/clean/teams/admin/widgets/invite_modal/invite_modal_sidebar","modules/clean/react/growth/first_task/first_task","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/react/admin/teams/onboarding/web/components/invite_link_button","modules/clean/react/member_sidebar_actions","modules/clean/growth/smb_funnel/smb_funnel_logger"],(function(e,a,t,s,n,i,o,l,r,m,d,c,_,u,g,f,b,p,v,E,M,I,h,w,A){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),s=t.__importDefault(s),l=t.__importStar(l);var N=_.Viewer.get_viewer(),S=r.intl.formatMessage({defaultMessage:"Member",description:"This string appears on a dropdown menu option of the invite members modal. The 'Member' option is revoking Admin permissions."}),C=r.intl.formatMessage({defaultMessage:"Admin"});function L(e){return null!=e&&e!==f.ADMIN_ROLE.NONE}function T(e,a){void 0===a&&(a={}),m.TeamsWebActionsLogger.log(e,t.__assign({module_name:"first_task_imm",mobile_web:l.is_supported_mobile_browser()},a))}var k=function(e){var a=e.baseClass,n=e.tieredAdmin,i=e.memberList,o=e.memberActionsData,l=e.loggingExtras,c=e.handleOnClose,_=e.growthActSmbMWInvitesActive,u=["option-member","option-admin"],E=u[0],M=u[1],I={enabled:!0,id:"role-dropdown",options:[{apiId:E,label:S,tooltip:r.intl.formatMessage({defaultMessage:"Can view, edit, delete, comment on, and save files"})},{apiId:M,label:C,tooltip:r.intl.formatMessage({defaultMessage:"Member, but can invite and manage team members"})}]};return s.default.createElement("div",{className:a+"__members"},s.default.createElement("div",{className:a+"__members-header"},s.default.createElement(g.Image,{src:d.static_url("/static/images/growth/team-vflxkrqB-.svg"),className:a+"__members-image"}),r.intl.formatMessage({defaultMessage:"Members of {team}"},{team:N.team_name})),i.map((function(e,a){var i=o&&o[e.user_id],u=L(e.admin_role)?M:E,g=(function(e,a){return void 0===a&&(a=!1),e?L(e.admin_role)?a&&f.ADMIN_ROLE_NAMES[e.admin_role]||C:S:r.intl.formatMessage({defaultMessage:"Select between member or admin"})})(e,n);return s.default.createElement(v.MemberRow,{key:a,id:"member-row-"+a,userId:e.user_id,showInvited:e.team_join_state===w.JoinState.PENDING,avatarUrl:e.team_join_state!==w.JoinState.PENDING?e.photo_url||"":d.static_url("/static/images/growth/member-vflJ3QUg7.svg"),displayName:e.display_name,roleLabel:g,initials:e.initials,email:e.email,actionsData:i,handleOnClose:c,onChange:function(a){if(a!==u||n&&a===M){c();var s=a===M?"granted":"revoked",o=t.__assign(t.__assign({},l),{user_id:e.user_id});m.TeamsWebActionsLogger.log(s+"_admin_permissions_open",t.__assign({},o));var r=function(){m.TeamsWebActionsLogger.log(s+"_admin_permissions_cancel",t.__assign({},o))};n?b.showTeamAdminRolesModal({userId:e.user_id,displayName:e.display_name,isAdmin:L(e.admin_role),origAdminRole:null!=e.admin_role?e.admin_role:f.ADMIN_ROLE.NONE,success:function(a){if(m.TeamsWebActionsLogger.log(s+"_admin_permissions",t.__assign({},o)),i&&i.roleUpdateCallback){var n=JSON.parse(a)[e.user_id].admin_role;i.roleUpdateCallback(n)}},onRequestClose:i&&i.onClose,onSecondaryAction:r}):p.showAdminPermissionsModal({userId:e.user_id,displayName:e.display_name,enablePermissions:"option-admin"===a,limited:!1,team_id:N.team_id,onPrimaryAction:function(){if(m.TeamsWebActionsLogger.log(s+"_admin_permissions",t.__assign({},o)),i&&i.roleUpdateCallback){var e="option-admin"===a?f.ADMIN_ROLE.SUPER:f.ADMIN_ROLE.NONE;i.roleUpdateCallback(e)}},onRequestClose:i&&i.onClose,onSecondaryAction:r})}},optionGroup:N.work_user.id!==e.user_id?t.__assign(t.__assign({},I),{selectedApiId:u,label:g}):void 0,growthActSmbMWInvitesActive:_})})),1===i.length&&s.default.createElement(v.MemberRow,{id:"empty-row",userId:-1,empty:!0,avatarUrl:d.static_url("/static/images/growth/single-vflQ4gh9g.svg"),displayName:r.intl.formatMessage({defaultMessage:"Your team members will show up here"}),roleLabel:S,handleOnClose:c}))};a.FirstTaskInviteModal=function(e){var a=e.baseClass,t=e.showSidebar,m=e.memberList,d=e.emails,_=e.sentEmails,g=e.handleOnClose,f=e.focusRef,b=e.open,p=e.loggingExtras;s.default.useEffect((function(){var e=p.is_client?A.Platform.DESKTOP_SSCV:l.is_supported_mobile_browser()?A.Platform.MOBILE_WEB:A.Platform.DESKTOP_WEB;A.SMBFunnelLogger.setPlatform(e)}),[]);var v=1===m.length?r.intl.formatMessage({defaultMessage:"Invite team members"}):r.intl.formatMessage({defaultMessage:"Manage team members"}),w=m[0].user_id,N=s.default.createElement("div",{className:a+"__action-separator"},s.default.createElement(o.Text,{size:"small",color:"disabled",tagName:"span"},r.intl.formatMessage({defaultMessage:"Or",description:"A page separator line"})));return s.default.createElement(n.IntlProvider,{defaultLocale:"en-US",locale:r.localeToBcp47LangTag(u.USER_LOCALE)},s.default.createElement(i.Modal,{className:e.growthActSmbMWInvitesActive?"mw-invites-modal-sheet":"",open:b,ariaLabel:r.intl.formatMessage({defaultMessage:"Invite Members"}),displayCloseButton:!0,onRequestClose:function(){_.length&&M.showClinkTooltip(M.TooltipType.Members),g()},overlayClickClose:!0,width:t?960:699,overflowY:!0,focusedElementOnOpen:f,appElement:document.body,bodyClassName:"invite-modal "+a+" "+(t?a+"--sidebar-visible":"")},s.default.createElement(c.UXAnalyticsModalTracking,{id:"invite-modal"}),e.growthActSmbMWInvitesActive?s.default.createElement("div",{className:a+"__container"},s.default.createElement("div",{className:a+"__content"},s.default.createElement("div",{className:a+"__title"},r.intl.formatMessage({defaultMessage:"Invite team members",description:"Title content for First task IMM modal"})),s.default.createElement("div",{className:a+"__invite-content"},!!e.isInviteLinkEnabled&&s.default.createElement(h.InviteLinkButton,{buttonClass:a+"__button",notifyWith:"snackbar",userId:w,onClick:function(){return T(I.Events.SHARE_INVITE_CLICK)},onLinkCopied:function(){return T(I.Events.SHARE_INVITE_COPIED)},onShareAction:function(){return T(I.Events.SHARE_INVITE_SHEET_ACTION)},onShareDismiss:function(){return T(I.Events.SHARE_INVITE_SHEET_DISMISS)}},r.intl.formatMessage({defaultMessage:"Send invite link",description:"A button that will create an URL that user can share with another person to invite them to the team."})),!!e.isInviteLinkEnabled&&N,e.children),k(e))):s.default.createElement("div",{className:a+"__container"},s.default.createElement("div",{className:a+"__content"},s.default.createElement("div",{className:a+"__title"},v),s.default.createElement("div",{className:a+"__invite-content"},e.children),k(e)),t&&s.default.createElement(E.InviteModalSidebar,{baseClass:a,memberList:m,emails:d,sentEmails:_}))))}}));
//# sourceMappingURL=invite_modal_first_task.min.js-vflfRdLlQ.map