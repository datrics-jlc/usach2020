define("modules/clean/react/dbox_app_promo",["require","exports","tslib","classnames","create-react-class","react","react-dom-factories","prop-types","modules/clean/react/button","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,a,s,r,i,n,o,l,m,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importDefault(r),i=a.__importDefault(i),n=a.__importStar(n),o=a.__importStar(o),l=a.__importStar(l),t.DboxAppFeatureList=void 0,t.DboxAppPromoSection=void 0;var c=i.default.createElement,d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e={"dbox-app-promo-container":!0};return this.props.className&&(e[this.props.className]=!0),n.div({className:s.default(e)},n.div({className:"dbox-app-promo-title"},this.props.title),n.div({className:"dbox-app-promo"},this.props.children))},t.displayName="DboxAppPromo",t.propTypes={title:o.string,className:o.string},t})(i.default.Component);t.DboxAppPromo=d;var p=r.default({displayName:"Actionable",propTypes:{handler:o.func,progressMapper:o.func},getDefaultProps:function(){return{handler:function(){},progressMapper:function(e,t){return{disabled:e||t.disabled}}}},getInitialState:function(){return{inProgress:!1}},onClick:function(){var e=this;if(!this.state.inProgress){var t="function"==typeof this.props.handler?this.props.handler():void 0;return t&&"function"==typeof t.complete?(this.setState({inProgress:!0}),t.complete((function(){if(e.isMounted())return e.setState({inProgress:!1})}))):void 0}},render:function(){var e,t={};for(var a in this.props)e=this.props[a],["handler","children","progressMapper"].includes(a)||(t[a]=e);t.onClick=this.onClick,t.inProgress=this.state.inProgress;var s=this.props.progressMapper(this.state.inProgress,t);for(var a in s)e=s[a],t[a]=e;return i.default.cloneElement(i.default.Children.only(this.props.children),t)}});t.Actionable=p;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.div({className:"dbox-app-promo-banner"},n.div({className:"dbox-app-promo-banner-body"},n.div({className:"dbox-app-promo-banner-title"},this.props.title),n.div({className:"dbox-app-promo-banner-description"},this.props.description)),n.div({className:"dbox-app-promo-banner-buttons"},Array.from(this.props.buttons).map((function(e,t){return n.span({className:"dbox-app-promo-banner-button",key:"button-"+t},c(p,{handler:e.handler},c(l.button,{importance:"tertiary"},e.text)))}))),n.div({className:"clear"}))},t.displayName="DboxAppPromoBanner",t.propTypes={title:o.string,description:o.string,buttons:o.arrayOf(o.shape({text:o.string,handler:o.func}))},t})(i.default.Component);t.DboxAppPromoBanner=_;var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.div({className:"dbox-app-promo-3pane"},n.div({className:"dbox-app-promo-grid"},Array.from(this.props.columns).map((function(e,t){return n.div({className:"dbox-app-promo-grid-column",key:"c_"+t},e.imageSource&&e.imageSourceHiRes?n.div({className:"pane-image"},c(m.Image,{src:u.static_url(e.imageSource),srcHiRes:u.static_url(e.imageSourceHiRes)})):void 0,e.title?n.div({className:"pane-title"},e.title):void 0,n.div({className:"pane-text"},e.text))}))))},t.displayName="DboxAppPromoGrid",t.propTypes={columns:o.arrayOf(o.shape({title:o.string,text:o.string,imageSource:o.string,imageSourceHiRes:o.string}))},t.defaultProps={columns:[]},t})(i.default.Component);t.DboxAppPromoGrid=f;var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-image-pane":!0,"primary-position":this.props.isImagePrimary,"secondary-position":!this.props.isImagePrimary}),t=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-content-pane":!0,"primary-position":!this.props.isImagePrimary,"secondary-position":this.props.isImagePrimary});return n.div({className:"dbox-app-promo-image-text"},n.div({className:e},c(m.Image,{src:u.static_url(this.props.imageSource),srcHiRes:u.static_url(this.props.imageSourceHiRes)})),n.div({className:t},n.div({className:"dbox-app-promo-image-text-title"},this.props.title),n.div({className:"dbox-app-promo-image-text-text"},this.props.text,this.props.children)),n.div({className:"clear"}))},t.displayName="DboxAppPromoImageText",t.propTypes={imageSource:o.string,imageSourceHiRes:o.string,title:o.string,text:o.string,isImagePrimary:o.bool},t.defaultProps={isImagePrimary:!0},t})(i.default.Component);t.DboxAppPromoImageText=g})),define("modules/clean/teams/constants",["require","exports","modules/core/i18n"],(function(e,t,a){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ADMIN_ROLE={SUPER:0,USER_MANAGEMENT:1,HELPDESK:2,CUSTOM:3,LIMITED:4,NONE:-1},t.ADMIN_ROLE_NAMES={0:a.intl.formatMessage({defaultMessage:"Team Admin"}),1:a.intl.formatMessage({defaultMessage:"User Management Admin"}),2:a.intl.formatMessage({defaultMessage:"Support Admin"}),3:a.intl.formatMessage({defaultMessage:"Custom Admin"}),4:a.intl.formatMessage({defaultMessage:"Limited Admin"})},t.TEAM_MEMBERSHIP_TYPES={FULL:0,FREE:1},t.TEAM_MEMBERSHIP_TYPE_LABELS={},t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FREE]=a.intl.formatMessage({defaultMessage:"Limited"}),t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FULL]=a.intl.formatMessage({defaultMessage:"Full"}),t.TEAM_JOIN_REQUEST_STATE={DISCOVERY_DISABLED:1,CAN_AUTO_JOIN:3,APPROVAL_REQUIRED:4,WAITING_FOR_APPROVAL:5,REQUEST_APPROVED:6,REQUEST_REJECTED_OPEN:7,REQUEST_REJECTED_DISMISSED:8},t.REQUEST_MEMBERSHIP_POLICY_VALUES={REQUIRE_APPROVAL:0,AUTO_ACCEPT:1,DISABLED:2},t.REQUEST_MEMBERSHIP_POLICY_VALUE_AS_STRING=((s={})[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL]="require_approval",s[t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT]="auto_accept",s[t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED]="disabled",s),t.REQUEST_MEMBERSHIP_POLICY_VALUE_LIST=[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL,t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED],t.REQUEST_MEMBERSHIP_POLICY_STRINGS={},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL]={LABEL:a.intl.formatMessage({defaultMessage:"By Request"}),DESCRIPTION:a.intl.formatMessage({defaultMessage:"They can see it and ask to join"})},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT]={LABEL:a.intl.formatMessage({defaultMessage:"Open"}),DESCRIPTION:a.intl.formatMessage({defaultMessage:"They can see it and join on their own"})},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED]={LABEL:a.intl.formatMessage({defaultMessage:"Invite-only"}),DESCRIPTION:a.intl.formatMessage({defaultMessage:"They can join by invite only"})},t.NOTES_LINK_POLICY_VALUES={TEAM:0,PUBLIC:1},t.NOTES_LINK_POLICY_LABELS={},t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.TEAM]=a.intl.formatMessage({defaultMessage:"Just people on my team with the link"}),t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.PUBLIC]=a.intl.formatMessage({defaultMessage:"Anyone with the link"}),t.SETUP_WIZARD_STEP={EXISTING_TEAM:0,PROVISION:10,TEAM_FOLDER:20,FINISHING_UP:30,COMPLETED:100},t.TEAM_PROMO_STEPS={WELCOME:1,VERIFY_EMAIL:2,JOIN_EXISTING:3,CHOOSE_TEAM_NAME:4,CHOOSE_SETUP_TYPE:5,CREATE_COMPLETE:6,REQUEST_SUBMITTED:7}})),define("modules/clean/teams/new_limited_team_create_form",["require","exports","tslib","create-react-class","purify","react","react-addons-linked-state-mixin","react-transition-group","react-dom-factories","external/lodash","modules/clean/ajax","modules/clean/analytics","modules/clean/components/title_bubble","modules/clean/react/button","modules/clean/react/input","modules/clean/react/radio","modules/clean/teams/constants","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,a,s,r,i,n,o,l,m,u,c,d,p,_,f,g,h,E,b,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importStar(r),i=a.__importDefault(i),n=a.__importStar(n),l=a.__importStar(l),m=a.__importStar(m),u=a.__importStar(u),d=a.__importDefault(d),p=a.__importStar(p),_=a.__importStar(_),h=a.__importStar(h);var T=i.default.createElement,S=_.text,v=_.password,y=p.button;t.default=s.default({mixins:[n],displayName:"NewLimitedTeamCreateForm",getDefaultProps:function(){return{defaultMigrationType:"work",isMaestroDesign:!1}},getInitialState:function(){return{teamName:"",migrationType:this.props.defaultMigrationType,email:"",password:"",tosChecked:!1,errors:{},serverErrors:{},submitting:!1}},componentDidUpdate:function(){return this._updateErrors()},_getErrors:function(){var e={};return 0!==this.state.teamName.trim().length||this.props.isMaestroDesign||(e.team_name={message_text:E.intl.formatMessage({defaultMessage:"Please enter a company name"})}),"personal"===this.state.migrationType&&(0===this.state.email.trim().length&&(e.email={message_text:E.intl.formatMessage({defaultMessage:"Please enter an email address"})}),0===this.state.password.trim().length&&(e.password={message_text:E.intl.formatMessage({defaultMessage:"Please enter a password"})}),this.props.isMaestroDesign||this.state.tosChecked||(e.tos_agree={message_text:E.intl.formatMessage({defaultMessage:"Please check the box to continue"})})),e},_updateErrors:function(){var e=this._getErrors(),t=m.omitBy(this.state.errors,(function(t,a){return!(a in e)}));if(!m.isEqual(this.state.errors,t))return this.setState({errors:t})},_onCTAClick:function(e){var t=this;if(e.preventDefault(),!this.state.submitting){var a=this._getErrors();if(this.setState({errors:a}),m.isEmpty(a)){this.setState({submitting:!0,serverErrors:{}});var s=function(e,a,s){if(t.setState({submitting:!1}),"rate-limit"!==e.getResponseHeader("x-dropbox-app-error")){var r;try{r=JSON.parse(s)}catch(e){r={}}t._logErrors(r),null!=r.email&&[r.email.message_text,r.email.message_html].includes("email-taken")&&(r.email.message_text=E.intl.formatMessage({defaultMessage:"This e-mail is already taken."})),t.setState({serverErrors:r})}else b.Notify.error(E.intl.formatMessage({defaultMessage:"You can’t create more than two teams per user account. Please reach out to support if you’d like to create a new team."}))};return this.props.personalUser.email===this.state.email?((a={email:{}}).email.message_text=E.intl.formatMessage({defaultMessage:"You’re already signed in!"}),void this.setState({submitting:!1,serverErrors:a})):this.props.isMaestroDesign?void("personal"===this.state.migrationType?u.WebRequest({url:"/register_for_team_creation",data:{team_name:"My New Team",email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:!0},success:function(){return t.props.onSuccess({email:t.state.email,migrationType:t.state.migrationType},t.state.migrationType)},error:s}):"work"===this.state.migrationType&&this.props.onSuccess(this.state)):"work"===this.state.migrationType?u.WebRequest({url:"/team/create_limited",data:{team_name:this.state.teamName,tos_agree:!0,request_membership_policy:g.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,show_onboarding_on_team_creation:this.props.showOnboardingOnTeamCreation,_tk:h.get_uri().path},success:function(e){return t.props.onSuccess?"function"==typeof t.props.onSuccess?t.props.onSuccess(JSON.parse(e)):void 0:h.redirect(new M.URI({path:"/team",query:{team_created:"1"}}))},error:s}):u.WebRequest({url:"/register_for_team_creation",data:{team_name:this.state.teamName,email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:this.state.tosChecked},success:function(){return h.redirect("/verify_email_for_team_creation?email="+encodeURIComponent(t.state.email))},error:s})}this._logErrors(a)}},_logErrors:function(e){e=m.mapValues(e,(function(e){return e.message_text}));var t=Object.keys(e).length;t>0&&"work"!==this.state.migrationType&&(e.error_count=t,c.TeamsWebActionsLogger.log("create_new_team_dropbox_error",e),"email-taken"===e.email&&c.TeamsWebActionsLogger.log("entered_existing_account_info"))},_onKeyPress:function(e){if("Enter"===e.key)return this._onCTAClick(e)},_renderError:function(e){var t=(null!=this.state.errors[e]?this.state.errors[e].message_text:void 0)||(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_text:void 0);return t||null==(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)||(t=l.span({dangerouslySetInnerHTML:{__html:r.sanitize(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)}})),T(o.CSSTransition,{classNames:"form-error",in:!!t,timeout:100},l.div({className:"form-error",title:t},t))},_renderTeamNameForm:function(){return l.div({className:"team-name-form"},l.label({htmlFor:"team_name_input",className:"team-name-form__label"},E.intl.formatMessage({defaultMessage:"Team Name"})),this._renderError("team_name"),T(S,{valueLink:this.linkState("teamName"),className:"team-name-form__input",placeholder:E.intl.formatMessage({defaultMessage:"Company or organization name"}),"disable-errors":!0,autofocus:!0,id:"team_name_input",onKeyPress:this._onKeyPress}))},_renderSignupForm:function(){return l.div({key:"signup-form",className:"signup-form"},l.div({className:"signup-form-input"},this._renderError("email"),T(S,{valueLink:this.linkState("email"),className:"signup-form-input__email",placeholder:E.intl.formatMessage({defaultMessage:"Enter work email"}),"disable-errors":!0,inline:!0,onKeyPress:this._onKeyPress})),l.div({className:"signup-form-input"},this._renderError("password"),T(v,{valueLink:this.linkState("password"),className:"signup-form-input__password",placeholder:E.intl.formatMessage({defaultMessage:"Password"}),"disable-errors":!0,inline:!0,measureStrength:!0,onKeyPress:this._onKeyPress})),this.props.isMaestroDesign?l.div({className:"signup-form__tos-message"},E.intl.formatMessage({defaultMessage:"Your use of Dropbox is governed by the <termsLink>Dropbox Terms</termsLink>"},{termsLink:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.a.apply(l,a.__spreadArrays([{href:"/terms",target:"_blank"}],e))}})):l.div({className:"signup-form__tos"},this._renderError("tos_agree"),l.input({checkedLink:this.linkState("tosChecked"),className:"signup-form__tos-checkbox",type:"checkbox",id:"signup-form__tos-checkbox"}),l.label({htmlFor:"signup-form__tos-checkbox",className:"signup-form__tos-label"},E.intl.formatMessage({defaultMessage:"I agree to <termsLink>Dropbox Terms</termsLink>"},{termsLink:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.a.apply(l,a.__spreadArrays([{href:"/terms",target:"_blank"}],e))}}))))},getMigrationTypeValueLink:function(){var e=this;return{value:this.state.migrationType,requestChange:function(t){if(t!==e.state.migrationType)return c.TeamsWebActionsLogger.log("onboarding_creation_select_migration_option",{migration_type:t}),e.setState({migrationType:t})}}},workRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:E.intl.formatMessage({defaultMessage:"Convert my Dropbox account into a work Dropbox account"}),description:E.intl.formatMessage({defaultMessage:"All of your files will stay private until you choose to share them. If you use this Dropbox account for personal stuff, choose ‘Add a new Work Dropbox account’."})}:{title:E.intl.formatMessage({defaultMessage:"Make my current Dropbox a Team Dropbox"}),description:E.intl.formatMessage({defaultMessage:"All of your files will remain with “{user_email}”, and will stay private until you choose to share them. If you use this Dropbox mostly for personal stuff, choose “Create a new Team Dropbox.”"},{user_email:e.email}),title_bubble:E.intl.formatMessage({defaultMessage:"Converting your current Dropbox ({user_email}) to a Team Dropbox allows you to more easily share with teammates and organize company files. You will still have full ownership over your account. As the team creator, only you will have have admin permissions and are the only person who can upgrade the team to Dropbox Business."},{user_email:e.email}),bubble_direction:"east"},T(f.RadioItem,{value:"work",key:"work-option"},l.div({className:"migration-option"},l.h3({className:"migration-option__title"},t.title),l.div({className:"migration-option__description"},t.description,null!=t.title_bubble?[" ",T(d.default,{text:t.title_bubble,direction:t.bubble_direction},l.span({className:"migration-option__learn-more"},E.intl.formatMessage({defaultMessage:"Learn more"})))]:void 0)))},personalRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:E.intl.formatMessage({defaultMessage:"Add a new work Dropbox account"}),description:E.intl.formatMessage({defaultMessage:"Keep your work stuff separate by creating a work Dropbox account with 2GB of free space under a new account. You can move any files from your current Dropbox account [{user_email}] after you set up your new work Dropbox account."},{user_email:e.email})}:{title:E.intl.formatMessage({defaultMessage:"Create a new Team Dropbox"}),description:E.intl.formatMessage({defaultMessage:"Keep your work and personal files separate by creating a new Team Dropbox. You can move any files from your current Dropbox [{user_email}] after you set up your new Team Dropbox."},{user_email:e.email})},T(f.RadioItem,{value:"personal",key:"personal-option"},l.div({className:"migration-option"},l.h3({className:"migration-option__title"},t.title),l.div({className:"migration-option__description"},t.description," "),T(o.CSSTransition,{classNames:"signup-form",timeout:{appear:0,enter:500,exit:300},in:"personal"===this.state.migrationType,unmountOnExit:!0,mountOnEnter:!0},this._renderSignupForm())))},renderMaestro:function(e){return e=this.props.personalUser,l.div({className:"new-limited-team-create-form"},l.div({className:"account-migration-form"},T(f.RadioGroup,{variant:f.RadioItemVariant.Large,align:"top",legend:E.intl.formatMessage({defaultMessage:"Account migration options."}),valueLink:this.getMigrationTypeValueLink()},"work"===this.props.defaultMigrationType?[this.workRadioItem(e),this.personalRadioItem(e)]:[this.personalRadioItem(e),this.workRadioItem(e)])),l.div({className:"cta-form"},T(y,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?E.intl.formatMessage({defaultMessage:"Add work Dropbox account"}):E.intl.formatMessage({defaultMessage:"Create work Dropbox account"}))))},renderOriginal:function(e){return l.div({className:"new-limited-team-create-form"},this._renderTeamNameForm(),l.div({className:"account-migration-form"},T(f.RadioGroup,{variant:f.RadioItemVariant.Large,align:"top",legend:E.intl.formatMessage({defaultMessage:"Account migration options."}),valueLink:this.getMigrationTypeValueLink()},"personal"===this.props.defaultMigrationType?[this.personalRadioItem(e),this.workRadioItem(e)]:[this.workRadioItem(e),this.personalRadioItem(e)])),l.hr(),l.div({className:"cta-form"},T(y,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?E.intl.formatMessage({defaultMessage:"Continue"}):E.intl.formatMessage({defaultMessage:"Create Team Dropbox"}))))},render:function(){var e=this.props.personalUser;return this.props.isMaestroDesign?this.renderMaestro(e):this.renderOriginal(e)}})})),define("modules/clean/teams/team_choose",["require","exports","tslib","classnames","external/lodash","react","react-transition-group","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/react/button","modules/clean/react/image","modules/clean/react/title_bubble","modules/clean/static_urls","modules/clean/stormcrow/experiment","modules/clean/teams/constants","modules/clean/viewer","modules/constants/trademark","modules/core/i18n","modules/core/user_i18n","spectrum/checkbox","modules/clean/metrics/index","modules/clean/react/teams/team_discovery/data/logger","modules/core/uri"],(function(e,t,a,s,r,i,n,o,l,m,u,c,d,p,_,f,g,h,E,b,M,T,S,v,y,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importStar(r),i=a.__importDefault(i),l=a.__importDefault(l),u=a.__importStar(u),c=a.__importStar(c),p=a.__importStar(p),E=a.__importStar(E),S=a.__importStar(S);var x=E.TEAM_JOIN_REQUEST_STATE,N=[{id:"r2j-checkbox-0",label:T.intl.formatMessage({defaultMessage:"I need access to team files and folders to get work done."})},{id:"r2j-checkbox-1",label:T.intl.formatMessage({defaultMessage:"I need more space on Dropbox to store my work."})},{id:"r2j-checkbox-2",label:T.intl.formatMessage({defaultMessage:"I need to keep my work files secure."})}],R=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t,a=this.props.joinableTeams.slice(),s=[];null!=this.props.joinableTeams[0]&&this.props.joinableTeams[0].is_invite&&(s=this.props.joinableTeams.slice(0,1),a=a.slice(1));for(var r=0;r<a.length;r++){var n=a[r];if(n.join_request_state===x.REQUEST_APPROVED){s.push(n),a.splice(r,1);break}}return s.length>0&&(e=i.default.createElement(A,{origin:"team",cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:s,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:T.intl.formatMessage({defaultMessage:"{count, plural, one{Team invitation} other{Team invitations}}",description:"formatted title for a widget containing a list of teams that a member can request to join."},{count:s.length}),className:"invited-section"})),a.length>0&&(t=i.default.createElement(A,{origin:"team",cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:a,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:T.intl.formatMessage({defaultMessage:"{count, plural, one{Team you can join} other{Teams you can join}}",description:"formatted title for a widget containing a list of teams that a member can request to join."},{count:a.length})})),i.default.createElement("div",null,e,t)},t})(i.default.Component);t.TeamChooseWidget=R;var A=(function(e){function t(t){var a=e.call(this,t)||this;a.handleListItemCollapse=function(){a.setState({expandedListItemIndex:-1})},a.handleListItemExpand=function(e){a.setState({expandedListItemIndex:e})},a.isListItemDisabled=function(e){var t=a.state.expandedListItemIndex;return-1!==t&&t!==e},a.showMoreOnClick=function(){a.setState({expanded:!0}),o.TeamsWebActionsLogger.log("click_expand")};for(var s=a.props.joinableTeams,r=[],i=[x.WAITING_FOR_APPROVAL,x.REQUEST_APPROVED,x.REQUEST_REJECTED_OPEN],n=0,l=s;n<l.length;n++){var m=l[n];i.includes(m.join_request_state)?r.unshift(m.team_id):r.push(m.team_id)}return a.state={teamSortOrder:r,expanded:!1,expandedListItemIndex:-1},a}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(e.joinableTeams){var t=r.keyBy(e.joinableTeams,"team_id"),a=r.filter(this.state.teamSortOrder,(function(e){return!!t[e]}));a=r.uniq(a.concat(r.map(t,(function(e){return e.team_id})))),this.setState({teamSortOrder:a})}},t.prototype.componentDidMount=function(){this.logComponentRendered()},t.prototype.logComponentRendered=function(){var e=I.getBrowserTag(),t=this.props.origin;null==t&&(t="unknown");var a={browser:e,origin:t},s=y.getMetricsReporter().child(a).createCounter({ns:I.AMPNamespace.TEAM_DISCOVERY,name:"web/team_choose_list/component/rendered"},a);s.increment(1),s.record()},t.prototype.getSortedJoinableTeams=function(){var e=r.keyBy(this.props.joinableTeams,"team_id");return r.map(this.state.teamSortOrder,(function(t){return e[t]}))},t.prototype.renderShowMore=function(e){return i.default.createElement("li",{className:"team-list-show-more"},i.default.createElement("span",{className:"team-list-show-more-button",onClick:this.showMoreOnClick},T.intl.formatMessage({defaultMessage:"{count, plural, one{View {count} more} other{View {count} more}}",description:"Message on button to render all teams that a member can request to join, instead of the default subset."},{count:e})))},t.prototype.render=function(){var e=this,t=this.state,a=t.expanded,s=t.expandedListItemIndex,r=this.props,o=r.buttonImportance,l=r.cancelJoinTeamHandler,m=r.className,u=r.ctaNewTeamImportance,c=r.disableButtons,d=r.expSubgrowthBizTeamsR2jMessage,p=r.teamRowHighlight,f=r.hasTeamPendingApproval,h=r.initialNumTeamsToShow,E=r.joinTeamHandler,b=r.maxNamesToShow,M=r.showBusinessTeamIcon,S=r.showJoinTextForInvite,v=r.showTeamTypeLabels,y=r.staticRows,I=r.title,x=0;y&&h?x=Math.max(0,h-y.length):h&&(x=Math.max(0,h));var N,R,A=this.getSortedJoinableTeams().map((function(t,a){return i.default.createElement(L,{team:t,cancelJoinTeamHandler:l,joinTeamHandler:E,key:t.team_id,showBusinessTeamIcon:M,buttonImportance:o,maxNamesToShow:b,showTeamTypeLabels:v,disableButton:c,showJoinTextForInvite:S,teamRowHighlight:p,hasTeamPendingApproval:f,expSubgrowthBizTeamsR2jMessage:d,index:a,isDisabled:e.isListItemDisabled(a),isExpanded:a===s,onItemCollapse:e.handleListItemCollapse,onItemExpand:e.handleListItemExpand,showHomeSurfaceExistingTeamsExperiment:e.props.showHomeSurfaceExistingTeamsExperiment})})),w=A,C=null,k=[];return A.length>x&&(w=A.slice(0,x),a?k=A.slice(x):C=this.renderShowMore(A.length-x)),y&&y.forEach((function(e){var t=i.default.createElement(_.Image,{src:g.static_url("/static/images/teams/add_cir-vfl6sl23s.png"),srcHiRes:g.static_url("/static/images/teams/add_cir@2x-vflGMnZ12.png")}),s=i.default.createElement(P,{icon:t,title:e.title||T.intl.formatMessage({defaultMessage:"Create a new Team Dropbox"}),subtitle:e.subtitle,actionText:e.actionText||T.intl.formatMessage({defaultMessage:"Create"}),actionHandler:e.actionHandler,disableButton:c,importance:u});a?k.push(s):w.push(s)})),k&&(R=i.default.createElement(n.CSSTransition,{classNames:"team-list-show-more-section",appear:!1,enter:!0,exit:!0,timeout:{appear:0,enter:300,exit:300},unmountOnExit:!0},i.default.createElement("div",{className:"team-list-show-more-section"},k))),A.length>x&&(N=i.default.createElement(n.TransitionGroup,null,R)),i.default.createElement("div",{className:m},I&&I.length>0?i.default.createElement("div",{className:"team-list-title"},I):void 0,i.default.createElement("ol",{className:"team-list-view"},w,C,N))},t.defaultProps={maxNamesToShow:3,initialNumTeamsToShow:3,staticRows:[],disableButtons:!1},t})(i.default.Component);t.TeamJoinList=A;var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return i.default.createElement("li",{className:"team-list-item",key:this.props.title+this.props.subtitle},i.default.createElement("div",{className:"team-list-item-contents"},i.default.createElement("div",{className:"team-list-avatars"},i.default.createElement("div",{className:"team-list-item__custom-img u-mar-right-s"},this.props.icon)),i.default.createElement("div",{className:"team-list-item-body"},i.default.createElement("div",{className:"team-list-item-text team-list-item-title"},this.props.title),i.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},this.props.subtitle)),i.default.createElement("div",{className:"team-list-item-actions"},i.default.createElement(p.button,{importance:this.props.importance||"primary",disabled:this.props.disableButton,onClick:this.props.actionHandler},this.props.actionText)),i.default.createElement("div",{className:"clear"})))},t})(i.default.Component),L=(function(e){function t(t){var a=e.call(this,t)||this;return a.renderActionItemOnClick=function(){var e=a.props.team;a.props.cancelJoinTeamHandler(e)},a.formatDate=function(e){return c.nice_date_with_month_name(e,!0,!0)},a.state=a.getInitialState(),a}return a.__extends(t,e),t.prototype.componentDidUpdate=function(e,t){!0===t.submit&&this.setState(this.getInitialState(),(function(){e.onItemCollapse()}))},Object.defineProperty(t.prototype,"expSubgrowthBizTeamsR2jMessage",{get:function(){return h.Experiment(this.props.expSubgrowthBizTeamsR2jMessage)},enumerable:!0,configurable:!0}),t.prototype.getInitialState=function(){return{r2jCheckedReasons:N.reduce((function(e,t){return e[t.id]="unchecked",e}),{}),submit:!1}},t.prototype.isPendingState=function(e){return[x.WAITING_FOR_APPROVAL,x.REQUEST_REJECTED_OPEN].includes(e)},t.prototype.getCtaButton=function(e,t){var a=this.props,s=a.disableButton,r=a.hasTeamPendingApproval,n=a.isDisabled,o=a.isExpanded,l=a.showJoinTextForInvite,m=a.team,u=this.state.submit,c="",d=!1;return m.is_invite||m.join_request_state===x.REQUEST_APPROVED?l?(c=T.intl.formatMessage({defaultMessage:"Join"}),d=u||s):(c=T.intl.formatMessage({defaultMessage:"Accept Invitation"}),this.props.showHomeSurfaceExistingTeamsExperiment&&(c=T.intl.formatMessage({defaultMessage:"Join the team"})),d=u||s):this.isPendingState(m.join_request_state)?(c=T.intl.formatMessage({defaultMessage:"Asked to join"}),d=!0,e="tertiary"):m.join_request_state===x.APPROVAL_REQUIRED?(c=T.intl.formatMessage({defaultMessage:"Request to join"}),this.props.showHomeSurfaceExistingTeamsExperiment&&(c=T.intl.formatMessage({defaultMessage:"Ask to join"})),d=u||s,this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&(o?d=u||s:(c=T.intl.formatMessage({defaultMessage:"Continue"}),d=u||s||n))):m.join_request_state===x.CAN_AUTO_JOIN&&(c=T.intl.formatMessage({defaultMessage:"Join"}),d=u||s),r&&(d=d||m.join_request_state!==x.WAITING_FOR_APPROVAL),i.default.createElement(p.button,{importance:e,onClick:t,children:c,disabled:d})},t.prototype.getFormattedR2jReasons=function(){var e=this.state.r2jCheckedReasons,t=Object.keys(e).reduce((function(t,a){return"checked"===e[a]?t+1:t}),0);if(0!==t)return T.intl.formatMessage({defaultMessage:"{count, plural, one{This user selected the following reason they need to join your account:\n{reasons_list}} other{This user selected the following reasons they need to join your account:\n{reasons_list}}}",description:"A formatted message listing the reasons a user is asking to join a given team."},{count:t,reasons_list:Object.keys(e).reduce((function(t,a){return"checked"===e[a]?t.concat(T.intl.formatMessage({defaultMessage:"• {reason}\n"},{reason:N.find((function(e){return e.id===a})).label})):t}),"").trim()})},t.prototype.renderExpandedContent=function(){var e=this,t=this.props,a=t.isExpanded,s=t.joinTeamHandler,r=t.onItemCollapse,c=t.team;if(!a)return null;var d=b.Viewer.get_viewer().personal_user,_=d.display_name,f=d.photo_url;return i.default.createElement(n.CSSTransition,{classNames:"team-list-item-r2j-message",appear:!1,enter:!0,leave:!1,timeout:{enter:300},unmountOnExit:!0},i.default.createElement("div",{className:"team-list-item-r2j-message"},i.default.createElement("div",{className:"team-list-item-r2j-message-content"},i.default.createElement("div",{className:"team-list-item-r2j-message-heading"},i.default.createElement(l.default,{dimension:u.VALID_AVATAR_DIMENSIONS[2],optionalClass:"team-list-item-r2j-message-avatar",photoUrl:f,shape:"CIRCLE",defaultAvatar:i.default.createElement(m.InitialsAvatarWithColorDerivedFromName,{dimension:u.VALID_AVATAR_DIMENSIONS[2],initials:S.getInitials(_),name:_,optionalClass:"team-list-item-r2j-message-avatar",shape:"CIRCLE"})}),i.default.createElement("h2",{className:"team-list-item-r2j-message-title"},T.intl.formatMessage({defaultMessage:"Introduce yourself"}))),this.renderR2jFormInput()),i.default.createElement("div",{className:"team-list-item-r2j-message-footer"},i.default.createElement(p.button,{importance:"secondary",onClick:function(){r()},children:T.intl.formatMessage({defaultMessage:"Back"})}),this.getCtaButton("primary",(function(){e.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&s(c,e.getFormattedR2jReasons()),e.setState({submit:!0}),o.TeamsWebActionsLogger.log("click_team_join_primary_cta")})))))},t.prototype.renderR2jFormInput=function(){var e=this,t=this.state,s=t.r2jCheckedReasons,r=t.submit,n=function(t,s,r){e.setState((function(e){var s;return{r2jCheckedReasons:a.__assign(a.__assign({},e.r2jCheckedReasons),(s={},s[r.target.id]=t,s))}}))};return this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")?i.default.createElement("div",null,i.default.createElement("p",{className:"team-list-item-r2j-message-info"},T.intl.formatMessage({defaultMessage:"Your request is more likely to be accepted if you let the team admin know why you need to join the account."})),i.default.createElement("fieldset",null,i.default.createElement("legend",{className:"team-list-item-r2j-message-checkbox-legend"},T.intl.formatMessage({defaultMessage:"Select from the following reasons (optional)"})),N.map((function(e){return i.default.createElement("label",{className:"team-list-item-r2j-message-checkbox-label",htmlFor:e.id,key:e.id},e.label,i.default.createElement(v.Checkbox,{checked:s[e.id],className:"team-list-item-r2j-message-checkbox",disabled:r,id:e.id,name:"r2j-checkbox",onChange:n}))})))):null},t.prototype.renderActionItem=function(){var e=this,t=this.props,a=t.buttonImportance,s=t.index,r=t.isExpanded,n=t.joinTeamHandler,o=t.onItemExpand,l=t.team;if(r)return null;if(this.isPendingState(l.join_request_state)){if(l.join_request_state===x.WAITING_FOR_APPROVAL){var m=void 0;if(l.join_request_date){var u=this.formatDate(l.join_request_date);m=T.intl.formatMessage({defaultMessage:"Requested on {request_date}"},{request_date:u})}else m=T.intl.formatMessage({defaultMessage:"Requested"});return this.props.showHomeSurfaceExistingTeamsExperiment&&(m=""),i.default.createElement("div",{className:"cancel-request"},m,i.default.createElement("button",{onClick:this.renderActionItemOnClick,className:"button-as-link cancel-request__link"},T.intl.formatMessage({defaultMessage:"Cancel request"})))}var c=void 0;if(l.join_denied_date){var d=this.formatDate(l.join_denied_date);c=T.intl.formatMessage({defaultMessage:"Declined on {request_date}"},{request_date:d})}else c=T.intl.formatMessage({defaultMessage:"Request declined"});return i.default.createElement("div",{className:"declined-request"},c)}var p=a||"tertiary",_=function(){n(l),e.setState({submit:!0})};return l.join_request_state===x.APPROVAL_REQUIRED&&this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&(_=function(){o(s)}),this.getCtaButton(p,_)},t.prototype._generateMemberCountSpan=function(e){return i.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},T.intl.formatMessage({defaultMessage:"{count, plural, one{{count} member} other{{count} members}}",description:"Formatted count of current members already in a joinable team."},{count:e}))},t.prototype.renderMembersSection=function(e){var t,a,s,r=this.props.maxNamesToShow;if(r||(r=0),e.is_private){var n=this._generateMemberCountSpan(e.num_members);return i.default.createElement("div",{className:"team-list-item-members-section"},n)}if(e.inviting_user_name)return s="",e.members_to_display.forEach((function(e){s+=e.email+"\n"})),e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=T.intl.formatMessage({defaultMessage:"and {extra} more"},{extra:t})),i.default.createElement("div",{className:"team-list-item-members-section"},i.default.createElement(f.TitleBubble,{content:e.inviting_user_email||e.inviting_user_name,key:"invitee-name",position:f.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8},i.default.createElement("span",{className:"team-list-item-text team-list-item-invitee-name"},d.Emstring.em_snippet(T.intl.formatMessage({defaultMessage:"Invited by {admin_name}"},{admin_name:e.inviting_user_name}),30))),i.default.createElement("span",{className:"u-pad-xxs",key:"middle-dot"},T.intl.formatMessage({defaultMessage:"·"})),i.default.createElement(f.TitleBubble,{content:s,position:f.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},this._generateMemberCountSpan(e.num_members)));var o="";s="";for(var l=0;l<e.members_to_display.length;l++)a=e.members_to_display[l],l>r-1?s+=a.email+"\n":l===e.members_to_display.length-1?[0,r-1].includes(l)?o+=""+a.display_name:o+=T.intl.formatMessage({defaultMessage:"and {display_name}"},{display_name:a.display_name}):o+=a.display_name+", ";return e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=T.intl.formatMessage({defaultMessage:"and {extra} more"},{extra:t})),s?i.default.createElement("div",{className:"team-list-item-members-section"},i.default.createElement("span",{className:"team-member-names",key:"team-member-names"}," ",o),i.default.createElement(f.TitleBubble,{content:s,position:f.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},i.default.createElement("span",null,T.intl.formatMessage({defaultMessage:"{count, plural, one{and {count} more} other{and {count} more}}",description:"Text for a tooltip displayed when the user hovers over the list of members in a team that the user can request to join."},{count:e.num_members-r})))):i.default.createElement("span",{className:"team-list-item-members-section team-member-names"},o)},t.prototype.renderTeamLabel=function(e){if(this.props.showTeamTypeLabels&&this.props.showBusinessTeamIcon&&!e.is_limited){var t=i.default.createElement("div",{className:"business-team-tooltip__content"},i.default.createElement("div",{className:"tooltip-bold-text u-mar-bottom-xxs"},T.intl.formatMessage({defaultMessage:"{trademark_business} account"},{trademark_business:M.TRADEMARK_BUSINESS})),i.default.createElement("div",{className:"tooltip-normal-text"},T.intl.formatMessage({defaultMessage:"{team_name} owns and administers this Dropbox"},{team_name:e.team_name})));return i.default.createElement("span",{className:"business-team-tooltip__icon-container"},i.default.createElement(f.TitleBubble,{content:t,position:f.TitleBubble.POSITIONS.RIGHT,distanceFromTarget:12},i.default.createElement(_.Image,{src:g.static_url("/static/images/teams/building_icon-vflqiltW_.png"),srcHiRes:g.static_url("/static/images/teams/building_icon@2x-vflxby4HL.png"),alt:T.intl.formatMessage({defaultMessage:"Business team icon"}),className:"business-team-icon"})))}},t.prototype.render=function(){var e=this.props,t=e.isDisabled,a=e.team,r=e.teamRowHighlight,o={"is-inviting-team":a.is_invite||a.join_request_state===x.REQUEST_APPROVED,"team-list-item--disabled":t,"team-list-item--highlighted":r},l=this.renderMembersSection(a);if(this.props.showHomeSurfaceExistingTeamsExperiment&&(l=i.default.createElement("span",{className:"team-list-item-members-section admin-name-sub"},T.intl.formatMessage({defaultMessage:"Team admin: {admin_name}"},{admin_name:this.props.team.admin_name})),a.inviting_user_name&&(l=i.default.createElement("span",{className:"team-list-item-members-section inviting-user-name-sub"},T.intl.formatMessage({defaultMessage:"Invited to a team by {inviting_user_name}"},{inviting_user_name:a.inviting_user_name}))),this.isPendingState(a.join_request_state)&&a.join_request_state===x.WAITING_FOR_APPROVAL)){var m=void 0;if(a.join_request_date){var u=this.formatDate(a.join_request_date);m=T.intl.formatMessage({defaultMessage:"Request sent: {request_date}"},{request_date:u})}else m=T.intl.formatMessage({defaultMessage:"Request sent"});l=i.default.createElement("span",{className:"team-list-item-members-section request-date-sub"},m)}return i.default.createElement("li",{className:s.default("team-list-item",o)},i.default.createElement("div",{className:"team-list-item-contents"},i.default.createElement("div",{className:"team-list-item-body"},i.default.createElement("div",{className:"team-list-item-text team-list-item-title"},this.props.showHomeSurfaceExistingTeamsExperiment?i.default.createElement(_.Image,{className:"surface-existing-teams__team_card-building-icon",src:g.static_url("/static/images/team_discovery/building-vflji5Gxx.png"),srcHiRes:g.static_url("/static/images/team_discovery/building-icon@2x-vflRJs5ej.png")}):null,a.team_name,this.renderTeamLabel(a)),l),i.default.createElement("div",{className:"team-list-item-actions"},this.renderActionItem())),i.default.createElement(n.TransitionGroup,{className:"team-list-item-r2j-message"},this.renderExpandedContent()),i.default.createElement("div",{className:"clear"}))},t})(i.default.Component)}));
//# sourceMappingURL=pkg-legacy-al.min.js-vfl2n3ez1.map